import"./DsnmJJEf.js";import{w as ms,h as V,a as W,K as gs,aT as hs,f as z,a3 as ys,ah as vs,ay as fs,am as bs,aw as Y,z as ws,aU as _s,ak as w,g as Ss,i as Ts,j as Rs,k as F,l as xs,m as _,n as Ds,o as K,r as s,q as n,t as a,u as L}from"./Dw-ON4Vl.js";import{s as Is,r as js}from"./CH48f3QO.js";import{I as As}from"./050Uj4-A.js";function t(l,p,e=!1,u=!1,i=!1){var k=l,c="";ms(()=>{var d=gs;if(c===(c=p()??"")){V&&W();return}if(d.nodes_start!==null&&(hs(d.nodes_start,d.nodes_end),d.nodes_start=d.nodes_end=null),c!==""){if(V){z.data;for(var o=W(),f=o;o!==null&&(o.nodeType!==ys||o.data!=="");)f=o,o=vs(o);if(o===null)throw fs(),bs;Y(z,f),k=ws(o);return}var r=c+"";e?r=`<svg>${r}</svg>`:u&&(r=`<math>${r}</math>`);var m=_s(r);if((e||u)&&(m=w(m)),Y(w(m),m.lastChild),e||u)for(;w(m);)k.before(w(m));else k.before(m)}})}function Ls(l,p){Ss(p,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let e=js(p,["$$slots","$$events","$$legacy"]);const u=[["path",{d:"M12 6v6l4 2"}],["circle",{cx:"12",cy:"12",r:"10"}]];As(l,Is({name:"clock"},()=>e,{get iconNode(){return u},children:(i,k)=>{var c=Rs(),d=F(c);xs(d,()=>p.children??Ds),_(i,c)},$$slots:{default:!0}})),Ts()}const J={title:"My Docker Deployment Strategy",excerpt:"latest favorite strategy regarding docker deployment on Ubuntu Server",author:"Rifky Adni Putra",date:"2025-12-10",readTime:"15 min read",tags:["Docker","Kubernetes","Github","Github Action","Spring Boot"],featured:!0,slug:"docker-deployment"},{title:qs,excerpt:Vs,author:Ws,date:zs,readTime:Ys,tags:Js,featured:Qs,slug:Xs}=J;var Ps=K('<h1>From Local Development to Production VPS: A Multi-Environment Docker Deployment Strategy</h1> <h2>Introduction</h2> <p>Deploying microservices across different environments can be challenging. In this post, I’ll share my experience deploying a microservices architecture using Docker Compose for both local development and production VPS, with GitHub Actions for automated builds and Kubernetes configurations ready for future scaling.</p> <p>The key insight: <strong>use the same Docker images everywhere, but different orchestration configs per environment</strong>.</p> <h2>Architecture Overview</h2> <p>My deployment strategy uses:</p> <ul><li><strong>GitHub Actions</strong> for automated CI/CD and image building</li> <li><strong>GitHub Container Registry (GHCR)</strong> for storing Docker images</li> <li><strong>Docker Compose</strong> for local development and VPS production</li> <li><strong>Kubernetes manifests</strong> prepared for future horizontal scaling</li></ul> <p>The application consists of multiple services:</p> <ul><li>Spring Boot authentication service (Java)</li> <li>REST API service (Go)</li> <li>WebSocket session service (Go)</li> <li>PostgreSQL database</li> <li>Redis cache</li> <li>Traefik reverse proxy</li></ul> <h2>Part 1: Automated Image Building with GitHub Actions</h2> <h3>Setting Up the Build Pipeline</h3> <p>First, I created a GitHub Actions workflow that builds Docker images whenever I push code. The workflow is triggered only when the commit message contains <code>--build</code> to avoid unnecessary builds.</p> <p><strong>Key workflow file: <code>.github/workflows/build.yml</code></strong></p> <pre class="language-yaml"><!></pre> <p>The workflow automatically:</p> <ol><li>Compiles the application</li> <li>Runs tests</li> <li>Builds Docker images</li> <li>Pushes images to GitHub Container Registry</li></ol> <p><strong>Pro tip</strong>: Use <code>$&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;</code> which is automatically available in GitHub Actions - no manual secret creation needed for pushing to GHCR!</p> <h3>Release Pipeline for Versioned Deployments</h3> <p>For production releases, I use a separate workflow triggered by Git tags:</p> <pre class="language-yaml"><!></pre> <p>This creates both versioned tags (e.g., <code>v1.0.0</code>) and <code>latest</code> tags.</p> <p><strong>To trigger a release:</strong></p> <pre class="language-bash"><!></pre> <h2>Part 2: Local Development with Docker Compose</h2> <h3>Development Configuration</h3> <p>For local development, I use <code>docker/docker-compose.yml</code> which <strong>builds images locally</strong> from source:</p> <pre class="language-yaml"><!></pre> <p><strong>Key differences in dev config:</strong></p> <ul><li>Uses <code>build:</code> directive to compile from source</li> <li>Default environment variables for quick setup</li> <li>Debug-level logging</li> <li>No restart policies (fails fast for debugging)</li></ul> <h3>Running Locally</h3> <pre class="language-bash"><!></pre> <p>The development setup uses Traefik for routing, matching the production setup exactly.</p> <h2>Part 3: Production Deployment on Ubuntu VPS</h2> <h3>Creating a GitHub Personal Access Token</h3> <p>To pull private images from GHCR on your VPS, you need a Personal Access Token:</p> <ol><li>Go to GitHub → Settings → Developer settings → Personal access tokens → Tokens (classic)</li> <li>Click “Generate new token (classic)”</li> <li>Select scopes: <ul><li><code>read:packages</code> - Download packages from GitHub Package Registry</li> <li><code>write:packages</code> - Upload packages to GitHub Package Registry (if needed)</li></ul></li> <li>Generate token and <strong>save it securely</strong></li></ol> <h3>Production Configuration</h3> <p>The production config (<code>docker/docker-compose.prod.yml</code>) uses <strong>pre-built images</strong> from GHCR:</p> <pre class="language-yaml"><!></pre> <p><strong>Key differences in production:</strong></p> <ul><li>Uses <code>image:</code> instead of <code>build:</code></li> <li><code>restart: unless-stopped</code> for automatic recovery</li> <li>INFO-level logging (not DEBUG)</li> <li>No default secrets (fails if not configured)</li> <li>Version pinning via <code>IMAGE_TAG</code> environment variable</li></ul> <h3>VPS Deployment Steps</h3> <p><strong>1. Prepare the VPS (Ubuntu 22.04)</strong></p> <pre class="language-bash"><!></pre> <p><strong>2. Login to GitHub Container Registry</strong></p> <pre class="language-bash"><!></pre> <p>You should see: <code>Login Succeeded</code></p> <p><strong>3. Clone and Configure</strong></p> <pre class="language-bash"><!></pre> <p><strong>4. Pull Images and Start Services</strong></p> <pre class="language-bash"><!></pre> <p><strong>5. Verify Deployment</strong></p> <pre class="language-bash"><!></pre> <h3>Updating Production</h3> <p>When you release a new version:</p> <pre class="language-bash"><!></pre> <h3>Rollback Strategy</h3> <p>If something goes wrong:</p> <pre class="language-bash"><!></pre> <h2>Part 4: Kubernetes for Future Scaling</h2> <p>While Docker Compose works great for single-server deployments, I’ve prepared Kubernetes manifests for when horizontal scaling is needed.</p> <h3>Namespace and ConfigMap</h3> <p><strong><code>k8s/namespace.yaml</code></strong></p> <pre class="language-yaml"><!></pre> <p><strong><code>k8s/configmap.yaml</code></strong></p> <pre class="language-yaml"><!></pre> <h3>Deployment Configuration</h3> <p><strong><code>k8s/auth-service-deployment.yaml</code></strong></p> <pre class="language-yaml"><!></pre> <h3>Traefik Ingress Routes</h3> <p><strong><code>k8s/traefik-ingressroute.yaml</code></strong></p> <pre class="language-yaml"><!></pre> <h3>Deploying to Kubernetes</h3> <pre class="language-bash"><!></pre> <h3>Horizontal Pod Autoscaling</h3> <p>For automatic scaling based on load:</p> <pre class="language-yaml"><!></pre> <h2>Best Practices and Lessons Learned</h2> <h3>1. Environment Variable Management</h3> <p><strong>DO:</strong></p> <ul><li>Use <code>.env</code> files for local development</li> <li>Use secrets management in production (K8s secrets, Vault, etc.)</li> <li>Never commit secrets to Git</li> <li>Generate strong random secrets: <code>openssl rand -base64 64</code></li></ul> <p><strong>DON’T:</strong></p> <ul><li>Hardcode secrets in Docker Compose files</li> <li>Use default passwords in production</li> <li>Share the same secrets across environments</li></ul> <h3>2. Image Tagging Strategy</h3> <pre class="language-bash"><!></pre> <h3>3. Health Checks</h3> <p>Always implement health checks in:</p> <ul><li>Docker Compose: <code>healthcheck:</code></li> <li>Kubernetes: <code>livenessProbe:</code> and <code>readinessProbe:</code></li> <li>Application: dedicated <code>/health</code> endpoint</li></ul> <h3>4. Resource Limits</h3> <p>Set appropriate limits to prevent resource exhaustion:</p> <pre class="language-yaml"><!></pre> <h3>5. Logging Strategy</h3> <ul><li><strong>Development</strong>: DEBUG level, stdout</li> <li><strong>Production</strong>: INFO level, structured JSON logs</li> <li>Use log aggregation (ELK, Loki) in production</li></ul> <h3>6. Database Persistence</h3> <p>Always use volumes for stateful services:</p> <pre class="language-yaml"><!></pre> <p>Backup regularly:</p> <pre class="language-bash"><!></pre> <h2>Comparison: Docker Compose vs Kubernetes</h2> <table><thead><tr><th>Feature</th><th>Docker Compose</th><th>Kubernetes</th></tr></thead><tbody><tr><td><strong>Setup Complexity</strong></td><td>Low</td><td>High</td></tr><tr><td><strong>Learning Curve</strong></td><td>Gentle</td><td>Steep</td></tr><tr><td><strong>Single Server</strong></td><td>Excellent</td><td>Overkill</td></tr><tr><td><strong>Multi-Server</strong></td><td>Limited</td><td>Excellent</td></tr><tr><td><strong>Auto-scaling</strong></td><td>No</td><td>Yes (HPA)</td></tr><tr><td><strong>Self-healing</strong></td><td>Limited</td><td>Robust</td></tr><tr><td><strong>Rolling Updates</strong></td><td>Manual</td><td>Automatic</td></tr><tr><td><strong>Cost</strong></td><td>Low</td><td>Higher</td></tr><tr><td><strong>Best For</strong></td><td>Small apps, dev</td><td>Production at scale</td></tr></tbody></table> <p><strong>My recommendation:</strong></p> <ul><li>Start with Docker Compose for MVP and small deployments</li> <li>Prepare K8s configs early (like I did)</li> <li>Migrate to K8s when you need: <ul><li>Multiple servers</li> <li>Auto-scaling</li> <li>High availability</li> <li>Advanced deployment strategies</li></ul></li></ul> <h2>Monitoring and Maintenance</h2> <h3>Docker Compose Monitoring</h3> <pre class="language-bash"><!></pre> <h3>Kubernetes Monitoring</h3> <pre class="language-bash"><!></pre> <h2>Conclusion</h2> <p>This multi-environment deployment strategy provides:</p> <p>✅ <strong>Consistency</strong>: Same Docker images across all environments<br/> ✅ <strong>Flexibility</strong>: Different orchestration per environment<br/> ✅ <strong>Scalability</strong>: Kubernetes ready when needed<br/> ✅ <strong>Automation</strong>: GitHub Actions handles builds<br/> ✅ <strong>Security</strong>: Proper secrets management<br/> ✅ <strong>Reliability</strong>: Health checks and restart policies</p> <p><strong>Key takeaways:</strong></p> <ol><li>Automate image building with GitHub Actions</li> <li>Use GHCR for private image hosting (free!)</li> <li>Separate configs for dev and prod</li> <li>Prepare for scale with K8s manifests</li> <li>Never compromise on secrets and monitoring</li></ol> <p>The beauty of this approach is that it scales with your needs - start simple with Docker Compose, and when traffic demands it, you’re already prepared with Kubernetes configurations.</p> <hr/> <p><strong>Repository</strong>: <strong>private</strong> <a href="https://github.com/rifkyputra/soundboard-api" rel="nofollow">soundboard-api</a></p> <p><strong>Tech Stack</strong>: Spring Boot, Go, PostgreSQL, Redis, Traefik, Docker, Kubernetes</p> <p><strong>Deployment</strong>: Local dev + Ubuntu VPS  (K8s ready)</p>',1);function Cs(l){var p=Ps(),e=s(F(p),26),u=n(e);t(u,()=>`<code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Build and Test

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span>
  <span class="token key atrule">workflow_dispatch</span><span class="token punctuation">:</span>

<span class="token key atrule">env</span><span class="token punctuation">:</span>
  <span class="token key atrule">REGISTRY</span><span class="token punctuation">:</span> ghcr.io
  <span class="token key atrule">IMAGE_NAME</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> github.repository <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build-auth-service</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Build Auth Service (Java/Spring Boot)
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">if</span><span class="token punctuation">:</span> contains(github.event.head_commit.message<span class="token punctuation">,</span> '<span class="token punctuation">-</span><span class="token punctuation">-</span>build')
    <span class="token key atrule">permissions</span><span class="token punctuation">:</span>
      <span class="token key atrule">contents</span><span class="token punctuation">:</span> read
      <span class="token key atrule">packages</span><span class="token punctuation">:</span> write

    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout code
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v4

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up JDK 17
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>java@v4
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">java-version</span><span class="token punctuation">:</span> <span class="token string">"17"</span>
          <span class="token key atrule">distribution</span><span class="token punctuation">:</span> <span class="token string">"temurin"</span>
          <span class="token key atrule">cache</span><span class="token punctuation">:</span> maven

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build with Maven
        <span class="token key atrule">working-directory</span><span class="token punctuation">:</span> ./auth<span class="token punctuation">-</span>service
        <span class="token key atrule">run</span><span class="token punctuation">:</span> mvn clean package <span class="token punctuation">-</span>DskipTests

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Log in to Container Registry
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/login<span class="token punctuation">-</span>action@v3
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">registry</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> env.REGISTRY <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
          <span class="token key atrule">username</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> github.actor <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
          <span class="token key atrule">password</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.GITHUB_TOKEN <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build and push Docker image
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/build<span class="token punctuation">-</span>push<span class="token punctuation">-</span>action@v5
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">context</span><span class="token punctuation">:</span> ./auth<span class="token punctuation">-</span>service
          <span class="token key atrule">push</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">tags</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> env.REGISTRY <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>/$<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> env.IMAGE_NAME <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>/auth<span class="token punctuation">-</span>service<span class="token punctuation">:</span>latest</code>`),a(e);var i=s(e,12),k=n(i);t(k,()=>`<code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Release

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">tags</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"v*.*.*"</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build-and-release</span><span class="token punctuation">:</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Extract version
        <span class="token key atrule">id</span><span class="token punctuation">:</span> version
        <span class="token key atrule">run</span><span class="token punctuation">:</span> echo "VERSION=$<span class="token punctuation">&#123;</span>GITHUB_REF<span class="token comment">#refs/tags/&#125;" >> $GITHUB_OUTPUT</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build and push versioned images
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/build<span class="token punctuation">-</span>push<span class="token punctuation">-</span>action@v5
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">push</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">tags</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            $&#123;&#123; env.REGISTRY &#125;&#125;/$&#123;&#123; env.IMAGE_NAME &#125;&#125;/auth-service:$&#123;&#123; steps.version.outputs.VERSION &#125;&#125;
            $&#123;&#123; env.REGISTRY &#125;&#125;/$&#123;&#123; env.IMAGE_NAME &#125;&#125;/auth-service:latest</span></code>`),a(i);var c=s(i,6),d=n(c);t(d,()=>`<code class="language-bash"><span class="token function">git</span> tag <span class="token parameter variable">-a</span> v1.0.0 <span class="token parameter variable">-m</span> <span class="token string">"Release version 1.0.0"</span>
<span class="token function">git</span> push origin v1.0.0</code>`),a(c);var o=s(c,8),f=n(o);t(f,()=>`<code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.9"</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">auth-service</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> ../auth<span class="token punctuation">-</span>service
      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> soundboard<span class="token punctuation">-</span>auth<span class="token punctuation">-</span>service
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">DB_HOST</span><span class="token punctuation">:</span> postgres
      <span class="token key atrule">JWT_SECRET</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span>JWT_SECRET<span class="token punctuation">:</span><span class="token punctuation">-</span>your<span class="token punctuation">-</span>secret<span class="token punctuation">-</span>key<span class="token punctuation">-</span>change<span class="token punctuation">-</span>in<span class="token punctuation">-</span>production<span class="token punctuation">&#125;</span>
    <span class="token key atrule">labels</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"traefik.enable=true"</span>
      <span class="token punctuation">-</span> <span class="token string">"traefik.http.routers.auth-service.rule=PathPrefix(&#96;/auth&#96;)"</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token key atrule">postgres</span><span class="token punctuation">:</span>
        <span class="token key atrule">condition</span><span class="token punctuation">:</span> service_healthy
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> soundboard<span class="token punctuation">-</span>network</code>`),a(o);var r=s(o,8),m=n(r);t(m,()=>`<code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token function">docker</span>
<span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>

<span class="token comment"># View logs</span>
<span class="token function">docker-compose</span> logs <span class="token parameter variable">-f</span>

<span class="token comment"># Test the services</span>
<span class="token function">curl</span> http://localhost/auth/health</code>`),a(r);var g=s(r,16),S=n(g);t(S,()=>`<code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.9"</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">auth-service</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> ghcr.io/rifkyputra/soundboard<span class="token punctuation">-</span>api/auth<span class="token punctuation">-</span>service<span class="token punctuation">:</span>$<span class="token punctuation">&#123;</span>IMAGE_TAG<span class="token punctuation">:</span><span class="token punctuation">-</span>latest<span class="token punctuation">&#125;</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> soundboard<span class="token punctuation">-</span>auth<span class="token punctuation">-</span>service
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">DB_HOST</span><span class="token punctuation">:</span> postgres
      <span class="token key atrule">JWT_SECRET</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span>JWT_SECRET<span class="token punctuation">&#125;</span>  <span class="token comment"># No default - must be set!</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped
    <span class="token key atrule">labels</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"traefik.enable=true"</span>
      <span class="token punctuation">-</span> <span class="token string">"traefik.http.routers.auth-service.rule=PathPrefix(&#96;/auth&#96;)"</span></code>`),a(g);var h=s(g,10),T=n(h);t(T,()=>`<code class="language-bash"><span class="token comment"># Update system</span>
<span class="token function">sudo</span> <span class="token function">apt</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt</span> upgrade <span class="token parameter variable">-y</span>

<span class="token comment"># Install Docker</span>
<span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://get.docker.com <span class="token parameter variable">-o</span> get-docker.sh
<span class="token function">sudo</span> <span class="token function">sh</span> get-docker.sh

<span class="token comment"># Install Docker Compose</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> docker-compose-plugin

<span class="token comment"># Add user to docker group</span>
<span class="token function">sudo</span> <span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">docker</span> <span class="token environment constant">$USER</span>
newgrp <span class="token function">docker</span></code>`),a(h);var y=s(h,4),R=n(y);t(R,()=>`<code class="language-bash"><span class="token comment"># Use your GitHub username and the token you created</span>
<span class="token builtin class-name">echo</span> YOUR_GITHUB_TOKEN <span class="token operator">|</span> <span class="token function">docker</span> login ghcr.io <span class="token parameter variable">-u</span> YOUR_GITHUB_USERNAME --password-stdin</code>`),a(y);var v=s(y,6),x=n(v);t(x,()=>`<code class="language-bash"><span class="token comment"># Clone your repository</span>
<span class="token function">git</span> clone https://github.com/rifkyputra/soundboard-api.git
<span class="token builtin class-name">cd</span> soundboard-api/docker

<span class="token comment"># Create production environment file</span>
<span class="token function">cat</span> <span class="token operator">></span> .env.prod <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
# Database Configuration
DB_USER=postgres
DB_PASSWORD=<span class="token variable"><span class="token variable">$(</span>openssl rand <span class="token parameter variable">-base64</span> <span class="token number">32</span><span class="token variable">)</span></span>
DB_NAME=soundboard_db

# JWT Secret - MUST be strong in production
JWT_SECRET=<span class="token variable"><span class="token variable">$(</span>openssl rand <span class="token parameter variable">-base64</span> <span class="token number">64</span><span class="token variable">)</span></span>

# Image Version
IMAGE_TAG=latest  # or use specific version like v1.0.0
EOF</span>

<span class="token comment"># Secure the env file</span>
<span class="token function">chmod</span> <span class="token number">600</span> .env.prod</code>`),a(v);var b=s(v,4),D=n(b);t(D,()=>`<code class="language-bash"><span class="token comment"># Pull latest images from GHCR</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml --env-file .env.prod pull

<span class="token comment"># Start all services</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml --env-file .env.prod up <span class="token parameter variable">-d</span>

<span class="token comment"># Check status</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml <span class="token function">ps</span>

<span class="token comment"># View logs</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml logs <span class="token parameter variable">-f</span></code>`),a(b);var I=s(b,4),Z=n(I);t(Z,()=>`<code class="language-bash"><span class="token comment"># Check health endpoints</span>
<span class="token function">curl</span> http://localhost/auth/health
<span class="token function">curl</span> http://localhost/api/health

<span class="token comment"># View Traefik dashboard</span>
<span class="token function">curl</span> http://localhost:8080/api/http/routers</code>`),a(I);var j=s(I,6),ss=n(j);t(ss,()=>`<code class="language-bash"><span class="token comment"># Update IMAGE_TAG in .env.prod</span>
<span class="token function">vim</span> .env.prod  <span class="token comment"># Change IMAGE_TAG=v1.0.1</span>

<span class="token comment"># Pull new images</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml --env-file .env.prod pull

<span class="token comment"># Recreate containers with zero downtime</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml --env-file .env.prod up <span class="token parameter variable">-d</span>

<span class="token comment"># Verify</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml <span class="token function">ps</span></code>`),a(j);var A=s(j,6),ns=n(A);t(ns,()=>`<code class="language-bash"><span class="token comment"># Set previous version</span>
<span class="token builtin class-name">echo</span> <span class="token string">"IMAGE_TAG=v1.0.0"</span> <span class="token operator">>></span> .env.prod

<span class="token comment"># Pull and restart</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml --env-file .env.prod pull
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml --env-file .env.prod up <span class="token parameter variable">-d</span></code>`),a(A);var P=s(A,10),as=n(P);t(as,()=>`<code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Namespace
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> soundboard</code>`),a(P);var C=s(P,4),ts=n(C);t(ts,()=>`<code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>config
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> soundboard
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">DB_HOST</span><span class="token punctuation">:</span> postgres<span class="token punctuation">-</span>service
  <span class="token key atrule">DB_PORT</span><span class="token punctuation">:</span> <span class="token string">"5432"</span>
  <span class="token key atrule">DB_NAME</span><span class="token punctuation">:</span> soundboard_db
  <span class="token key atrule">REDIS_HOST</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>service
  <span class="token key atrule">REDIS_PORT</span><span class="token punctuation">:</span> <span class="token string">"6379"</span></code>`),a(C);var G=s(C,6),es=n(G);t(es,()=>`<code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> auth<span class="token punctuation">-</span>service
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> soundboard
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>  <span class="token comment"># High availability</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> auth<span class="token punctuation">-</span>service
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> auth<span class="token punctuation">-</span>service
        <span class="token key atrule">image</span><span class="token punctuation">:</span> ghcr.io/rifkyputra/soundboard<span class="token punctuation">-</span>api/auth<span class="token punctuation">-</span>service<span class="token punctuation">:</span>latest
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
        <span class="token key atrule">envFrom</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">configMapRef</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>config
        <span class="token punctuation">-</span> <span class="token key atrule">secretRef</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> db<span class="token punctuation">-</span>credentials
        <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>
          <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span> /auth/actuator/health
            <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
          <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">30</span>
        <span class="token key atrule">resources</span><span class="token punctuation">:</span>
          <span class="token key atrule">requests</span><span class="token punctuation">:</span>
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"256Mi"</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"250m"</span>
          <span class="token key atrule">limits</span><span class="token punctuation">:</span>
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"512Mi"</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"500m"</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> auth<span class="token punctuation">-</span>service
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> soundboard
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> auth<span class="token punctuation">-</span>service
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">8080</span></code>`),a(G);var E=s(G,6),os=n(E);t(os,()=>`<code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> traefik.io/v1alpha1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> IngressRoute
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> soundboard<span class="token punctuation">-</span>auth<span class="token punctuation">-</span>route
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> soundboard
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">entryPoints</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> web
  <span class="token key atrule">routes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">match</span><span class="token punctuation">:</span> PathPrefix(&#96;/auth&#96;)
    <span class="token key atrule">kind</span><span class="token punctuation">:</span> Rule
    <span class="token key atrule">services</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> auth<span class="token punctuation">-</span>service
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span></code>`),a(E);var M=s(E,4),ps=n(M);t(ps,()=>`<code class="language-bash"><span class="token comment"># Create namespace</span>
kubectl apply <span class="token parameter variable">-f</span> k8s/namespace.yaml

<span class="token comment"># Create secrets (base64 encoded)</span>
kubectl create secret generic db-credentials <span class="token punctuation"></span>
  --from-literal<span class="token operator">=</span>DB_USER<span class="token operator">=</span>postgres <span class="token punctuation"></span>
  --from-literal<span class="token operator">=</span>DB_PASSWORD<span class="token operator">=</span>your-password <span class="token punctuation"></span>
  <span class="token parameter variable">-n</span> soundboard

kubectl create secret generic jwt-secret <span class="token punctuation"></span>
  --from-literal<span class="token operator">=</span>JWT_SECRET<span class="token operator">=</span>your-jwt-secret <span class="token punctuation"></span>
  <span class="token parameter variable">-n</span> soundboard

<span class="token comment"># Apply configurations</span>
kubectl apply <span class="token parameter variable">-f</span> k8s/configmap.yaml
kubectl apply <span class="token parameter variable">-f</span> k8s/postgres-deployment.yaml
kubectl apply <span class="token parameter variable">-f</span> k8s/redis-deployment.yaml

<span class="token comment"># Deploy services</span>
kubectl apply <span class="token parameter variable">-f</span> k8s/auth-service-deployment.yaml
kubectl apply <span class="token parameter variable">-f</span> k8s/soundboard-api-deployment.yaml
kubectl apply <span class="token parameter variable">-f</span> k8s/session-service-deployment.yaml

<span class="token comment"># Setup ingress</span>
kubectl apply <span class="token parameter variable">-f</span> k8s/traefik-ingressroute.yaml

<span class="token comment"># Check status</span>
kubectl get pods <span class="token parameter variable">-n</span> soundboard
kubectl get services <span class="token parameter variable">-n</span> soundboard
kubectl get ingressroute <span class="token parameter variable">-n</span> soundboard</code>`),a(M);var U=s(M,6),cs=n(U);t(cs,()=>`<code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> autoscaling/v2
<span class="token key atrule">kind</span><span class="token punctuation">:</span> HorizontalPodAutoscaler
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> auth<span class="token punctuation">-</span>service<span class="token punctuation">-</span>hpa
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> soundboard
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">scaleTargetRef</span><span class="token punctuation">:</span>
    <span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
    <span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
    <span class="token key atrule">name</span><span class="token punctuation">:</span> auth<span class="token punctuation">-</span>service
  <span class="token key atrule">minReplicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">maxReplicas</span><span class="token punctuation">:</span> <span class="token number">10</span>
  <span class="token key atrule">metrics</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> Resource
    <span class="token key atrule">resource</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> cpu
      <span class="token key atrule">target</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> Utilization
        <span class="token key atrule">averageUtilization</span><span class="token punctuation">:</span> <span class="token number">70</span></code>`),a(U);var H=s(U,16),ls=n(H);t(ls,()=>`<code class="language-bash"><span class="token comment"># Development: Use latest</span>
<span class="token assign-left variable">IMAGE_TAG</span><span class="token operator">=</span>latest

<span class="token comment"># Staging: Use commit SHA</span>
<span class="token assign-left variable">IMAGE_TAG</span><span class="token operator">=</span>sha-abc123

<span class="token comment"># Production: Use semantic versioning</span>
<span class="token assign-left variable">IMAGE_TAG</span><span class="token operator">=</span>v1.0.0</code>`),a(H);var $=s(H,12),us=n($);t(us,()=>`<code class="language-yaml"><span class="token key atrule">resources</span><span class="token punctuation">:</span>
  <span class="token key atrule">requests</span><span class="token punctuation">:</span>  <span class="token comment"># Guaranteed resources</span>
    <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"256Mi"</span>
    <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"250m"</span>
  <span class="token key atrule">limits</span><span class="token punctuation">:</span>    <span class="token comment"># Maximum allowed</span>
    <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"512Mi"</span>
    <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"500m"</span></code>`),a($);var N=s($,10),rs=n(N);t(rs,()=>`<code class="language-yaml"><span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">postgres_data</span><span class="token punctuation">:</span>
  redis_data<span class="token punctuation">:</span></code>`),a(N);var B=s(N,4),is=n(B);t(is,()=>'<code class="language-bash"><span class="token function">docker</span> <span class="token builtin class-name">exec</span> postgres pg_dump <span class="token parameter variable">-U</span> postgres soundboard_db <span class="token operator">></span> backup.sql</code>'),a(B);var O=s(B,14),ks=n(O);t(ks,()=>`<code class="language-bash"><span class="token comment"># View resource usage</span>
<span class="token function">docker</span> stats

<span class="token comment"># Check logs</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml logs <span class="token parameter variable">-f</span>

<span class="token comment"># Restart specific service</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose.prod.yml restart auth-service</code>`),a(O);var q=s(O,4),ds=n(q);t(ds,()=>`<code class="language-bash"><span class="token comment"># Pod status</span>
kubectl get pods <span class="token parameter variable">-n</span> soundboard

<span class="token comment"># Detailed pod info</span>
kubectl describe pod <span class="token operator">&lt;</span>pod-name<span class="token operator">></span> <span class="token parameter variable">-n</span> soundboard

<span class="token comment"># Logs</span>
kubectl logs <span class="token parameter variable">-f</span> deployment/auth-service <span class="token parameter variable">-n</span> soundboard

<span class="token comment"># Resource usage</span>
kubectl <span class="token function">top</span> pods <span class="token parameter variable">-n</span> soundboard</code>`),a(q),L(20),_(l,p)}const Gs=Object.freeze(Object.defineProperty({__proto__:null,default:Cs,metadata:J},Symbol.toStringTag,{value:"Module"})),Q={title:"When React's Future Feels Like Next.js' Shadow",excerpt:"Exploring the complex relationship between React's evolution, Server Components, and the growing influence of Next.js on the React ecosystem.",author:"Rifky Adni Putra",date:"2025-10-16",readTime:"8 min read",tags:["React","Next.js","Server Components","web development","framework"],featured:!1,slug:"react-future-nextjs-shadow"},{title:Zs,excerpt:sn,author:nn,date:an,readTime:tn,tags:en,featured:on,slug:pn}=Q;var Es=K('<p>I’ve been watching React evolve for years now—through hooks, Suspense, concurrency, server actions—and there’s one pattern that keeps drawing attention: Server Components (RSCs). They’re ambitious, seductive. Less JavaScript, faster load times, closer coupling between data and view. But as I map that promise against reality, I can’t help but feel uneasy. Especially when so much of the momentum behind server components is riding on Next.js and Vercel.</p> <h2>Why Next.js & Vercel Matter More Than We Admit</h2> <p>Next.js isn’t just “another React framework” — today, it’s the way many developers experience React in production. It shapes how tutorials, libraries, and discourse talk about React. When the React core team rolls out a new feature, Next.js tends to adopt (or tailor) it first. That means Next often sits between the React vision and how we use it in real life.</p> <p>Vercel, as both steward of Next.js and a cloud platform, has a natural alignment with server rendering, edge functions, server actions, and anything that leverages their hosting model. The result: many of React’s new directions happen in tandem with Next.js’ needs, not in isolation.</p> <p>That’s not conspiracy — it’s influence. And it matters, because while Next.js is powerful, its priorities (server-first, edge, streaming) don’t match every app or team.</p> <h2>The Catch with Server Components in the Wild</h2> <p>I believe server components will be useful tools in many apps. But making them the default path is risky. Here’s where theory clashes with practice:</p> <h3>Mixed Mental Models</h3> <p>Now developers have to decide: is this component “server” or “client”? That choice carries restrictions (no effects, no browser APIs) and often forces splitting logic in awkward ways.</p> <h3>Lock-in Risks</h3> <p>Patterns designed around Next.js expectations—its fetch caching, file conventions, routing semantics—don’t always travel well to custom setups or other frameworks.</p> <h3>Tooling Friction</h3> <p>Debugging boundary errors, serialization bugs, hydration mismatches—these are tricky even in Next/React teams. Expect that pain to scale worse in less constrained setups.</p> <h3>Performance Illusions</h3> <p>Some early benchmarks make server components seem magical, but real apps often show diminishing returns. The cost of round-trips, partial hydration, or redundant data fetching can erode the gains.</p> <h3>Adoption Inertia</h3> <p>Big codebases, established teams, and existing libraries won’t rewrite themselves overnight. Many teams will stay on client-heavy or classic SSR hybrids for years.</p> <h2>What I Think React’s Future Actually Looks Like</h2> <p>If I had to forecast, here’s how I see it:</p> <h3>Hybrid Becomes Default</h3> <p>Developers will blend server and client intelligently—server where it helps, client where interactivity demands it.</p> <h3>Smarter Hydration & Modular Rendering</h3> <p>Think along the lines of “islands” or “adaptive hydration” (as some early research suggests). The goal isn’t to eliminate client-side JavaScript, but to load it more strategically.</p> <h3>Framework-Agnostic Features</h3> <p>React features will aim to support Next.js, but also Remix, Astro, or even raw React setups. The ecosystem is too diverse for one framework to dictate everything.</p> <h3>Opt-in Server Components</h3> <p>Use them where they make sense (marketing pages, dashboards, data-rich but lightly interactive), not as a blanket rule.</p> <h2>The Bigger Picture</h2> <p>React’s evolution isn’t happening in a vacuum. The web platform itself is changing—with better caching, streaming, edge computing, and native modules. React server components are one response to these changes, but they’re not the only one.</p> <p>Other frameworks are exploring different approaches:</p> <ul><li><strong>SvelteKit</strong> with its load functions and server-side logic</li> <li><strong>Astro</strong> with its island architecture</li> <li><strong>Solid</strong> with its fine-grained reactivity</li></ul> <p>Each offers different trade-offs and mental models. React’s bet on server components is significant, but it’s not guaranteed to be the winning approach for every use case.</p> <h2>Moving Forward Thoughtfully</h2> <p>As developers, we should:</p> <ol><li><strong>Evaluate server components critically</strong> — not just accept them because they’re new</li> <li><strong>Consider our specific use cases</strong> — what works for Vercel’s platform might not work for your infrastructure</li> <li><strong>Keep learning alternatives</strong> — the React ecosystem is vast, and Next.js is just one part of it</li> <li><strong>Focus on fundamentals</strong> — good architecture, performance, and user experience matter more than any specific technology</li></ol> <p>React’s future is still being written. While Next.js and Vercel have significant influence, the broader community of developers, library authors, and framework creators will ultimately shape where we go next.</p> <p>The key is staying curious, staying critical, and remembering that every tool—including server components—is just that: a tool. Use it when it fits, but don’t let it define your entire approach to building for the web.</p> <hr/> <p><em>What are your thoughts on React Server Components and the influence of Next.js on React’s direction? I’d love to hear your perspective on <a href="https://twitter.com/0xrkyy" rel="nofollow">Twitter</a> or via <a href="mailto:rifkyadp@gmail.com">email</a>.</em></p>',1);function Ms(l){var p=Es();L(76),_(l,p)}const Us=Object.freeze(Object.defineProperty({__proto__:null,default:Ms,metadata:Q},Symbol.toStringTag,{value:"Module"})),X={title:"Getting Started with SvelteKit Remote Functions",excerpt:"How SvelteKit's Remote Functions let you write type-safe server logic and call it directly from your components.",author:"Rifky Adni Putra",date:"2025-10-16",readTime:"7 min read",tags:["SvelteKit","remote functions","web development","RPC"],featured:!1,slug:"sveltekit-remote-functions-guide"},{title:cn,excerpt:ln,author:un,date:rn,readTime:kn,tags:dn,featured:mn,slug:gn}=X;var Hs=K('<p>SvelteKit has introduced <strong>Remote Functions</strong> — an experimental feature aiming to streamline how you write server logic and call it safely from your components. In effect, it gives you an RPC-style paradigm, but with full type safety and automatic fetch wrapping. (<a href="https://svelte.dev/docs/kit/remote-functions?utm_source=chatgpt.com" title="Remote functions • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p> <h2>Why Remote Functions?</h2> <p>Traditionally, SvelteKit’s data fetching and mutations rely on:</p> <ul><li><code>load</code> / <code>+page.server.js</code> / <code>+layout.server.js</code> for server-side data loading (<a href="https://svelte.dev/docs/kit/load?utm_source=chatgpt.com" title="Loading data • Docs - Svelte" rel="nofollow">svelte.dev</a>)</li> <li>Endpoint files (e.g. <code>+server.ts</code>) or actions for mutations</li> <li><code>fetch</code> calls from client-side or through <code>load</code> functions</li></ul> <p>While this works, it can sometimes feel disjointed:</p> <ul><li>You may have to jump between endpoints and component code</li> <li>Type safety of client ↔ server communication can be weak</li> <li>Co-location is limited: logic tied to UI components may feel separate</li></ul> <p>Remote Functions aim to fix that. You write server-only logic in <code>.remote.ts</code> (or <code>.remote.js</code>) files, and import them in your Svelte components. On the server, they run directly; on the client, they compile to <code>fetch</code> wrappers under the hood. (<a href="https://github.com/sveltejs/kit/discussions/13897?utm_source=chatgpt.com" title="Remote Functions · sveltejs kit · Discussion #13897 - GitHub" rel="nofollow">GitHub</a>)</p> <p>They also provide type-safe serialization of arguments (via devalue) and runtime validation if you opt in with a schema.</p> <p>In Svelte’s docs:</p> <blockquote><p>Remote functions are a tool for type-safe communication between client and server. They can be called anywhere in your app, but always run on the server. (<a href="https://svelte.dev/docs/kit/remote-functions?utm_source=chatgpt.com" title="Remote functions • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p></blockquote> <p>The feature is experimental, so you have to explicitly enable it. (<a href="https://github.com/sveltejs/kit/discussions/13897?utm_source=chatgpt.com" title="Remote Functions · sveltejs kit · Discussion #13897 - GitHub" rel="nofollow">GitHub</a>)</p> <hr/> <h2>Enabling Remote Functions</h2> <p>To opt into this experimental feature, you need to adjust your SvelteKit configuration:</p> <pre class="language-js"><!></pre> <ul><li><code>kit.experimental.remoteFunctions = true</code> turns on remote functions support. (<a href="https://svelte.dev/docs/kit/remote-functions?utm_source=chatgpt.com" title="Remote functions • Docs - Svelte" rel="nofollow">svelte.dev</a>)</li> <li><code>compilerOptions.experimental.async = true</code> allows you to use <code>await</code> at the top level inside Svelte components (needed for <code>await remoteQuery()</code>) (<a href="https://github.com/sveltejs/kit/discussions/13897?utm_source=chatgpt.com" title="Remote Functions · sveltejs kit · Discussion #13897 - GitHub" rel="nofollow">GitHub</a>)</li></ul> <p>Once enabled, you can create files with suffix <code>.remote.ts</code> (or <code>.remote.js</code>) anywhere in your <code>src</code> (or routes) folder. The functions you export from them become your “remote” functions.</p> <hr/> <h2>The Four Flavors of Remote Functions</h2> <p>Remote functions come in four types:</p> <ol><li><strong>query</strong> — for fetching data (read)</li> <li><strong>command</strong> — for server-side mutations (writes)</li> <li><strong>form</strong> — for form handling (like actions, but built-in)</li> <li><strong>prerender</strong> — for build-time data logic</li></ol> <p>Let’s dive into each.</p> <h3><code>query</code></h3> <p>A <code>query</code> is a function meant to fetch data. Its signature usually looks like:</p> <pre class="language-ts"><!></pre> <p>You can also provide input validation:</p> <pre class="language-ts"><!></pre> <p>On the client side (inside a Svelte component), you can do:</p> <pre class="language-svelte"><!></pre> <p>Under the hood, SvelteKit generates a <code>fetch</code> wrapper for <code>getPosts</code> when used in the client. (<a href="https://svelte.dev/docs/kit/remote-functions?utm_source=chatgpt.com" title="Remote functions • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p> <p><code>query</code> also supports <code>batch</code> mode, where multiple calls can be aggregated in a single request. (<a href="https://svelte.dev/docs/kit/%24app-server?utm_source=chatgpt.com" title="$app/server • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p> <p>You can also manage loading/error states more explicitly:</p> <pre class="language-svelte"><!></pre> <p>You can also call <code>q.refresh()</code> to re-fetch. (<a href="https://svelte.dev/docs/kit/remote-functions?utm_source=chatgpt.com" title="Remote functions • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p> <h3><code>command</code></h3> <p><code>command</code> is for mutations or actions (server side). It wraps server-side logic that changes state:</p> <pre class="language-ts"><!></pre> <p>On the client, invoking <code>addLike(postId)</code> results in a remote call. You can also chain <code>updates(...)</code> to trigger query invalidations or optimistic updates. (<a href="https://svelte.dev/docs/kit/%40sveltejs-kit?utm_source=chatgpt.com" title="@sveltejs/kit • Docs • Svelte" rel="nofollow">svelte.dev</a>)</p> <h3><code>form</code></h3> <p><code>form</code> is particularly suited for form submissions. It produces an object you can spread onto a <code>&lt;form&gt;</code> element in your Svelte component:</p> <pre class="language-ts"><!></pre> <p>In your component:</p> <pre class="language-svelte"><!></pre> <p>It also supports <code>enhance(...)</code> for custom handling or optimistic updates. (<a href="https://svelte.dev/docs/kit/%40sveltejs-kit?utm_source=chatgpt.com" title="@sveltejs/kit • Docs • Svelte" rel="nofollow">svelte.dev</a>)</p> <h3><code>prerender</code></h3> <p>This is for build-time logic: you can compute values at build time (during prerender) that your components can use. It’s less commonly needed in dynamic apps but useful for static parts. (<a href="https://svelte.dev/docs/kit/%24app-server?utm_source=chatgpt.com" title="$app/server • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p> <hr/> <h2>Example: A Simple Todos App</h2> <p>Let’s sketch a minimal example using <code>query</code> + <code>command</code>.</p> <p><strong>File <code>todos.remote.ts</code></strong></p> <pre class="language-ts"><!></pre> <p><strong>In your Svelte component, e.g. <code>+page.svelte</code></strong></p> <pre class="language-svelte"><!></pre> <p>Note how we can call server methods (<code>addTodo</code>, <code>toggleTodo</code>) directly from the component without writing a separate API route. The <code>.updates(getTodos())</code> tells SvelteKit: after this command completes, refresh that query (or apply an optimistic update). (<a href="https://svelte.dev/docs/kit/remote-functions?utm_source=chatgpt.com" title="Remote functions • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p> <hr/> <h2>Best Practices & Gotchas</h2> <h3>✅ Use validation schemas</h3> <p>If your remote function expects input, validate it via a schema (e.g. <code>zod</code>) so malformed input is caught early. Without validation, everything is “unchecked.”</p> <h3>✅ Co-locate logic near usage</h3> <p>One of the biggest strengths: keep remote logic close to your UI so you don’t have to jump across directories.</p> <h3>✅ Be cautious with heavy logic</h3> <p>A remote function runs on the server and might block or slow down performance. Avoid putting very heavy tasks that should be delegated elsewhere.</p> <h3>✅ Understand SSR / hydration behavior</h3> <p>Because remote functions always run on server, even during SSR/hydration, they need to work without depending on browser globals. Also, if you call a query during SSR, SvelteKit may inline its result in HTML so it isn’t refetched on hydration. (<a href="https://svelte.dev/docs/kit/remote-functions?utm_source=chatgpt.com" title="Remote functions • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p> <h3>⚠️ Experimental, API may change</h3> <p>Remote Functions is still experimental as of 2025; expect changes. (<a href="https://svelte.dev/docs/kit/remote-functions?utm_source=chatgpt.com" title="Remote functions • Docs - Svelte" rel="nofollow">svelte.dev</a>)</p> <h3>⚠️ Don’t leak secrets accidentally</h3> <p>Because the client import is compiled to a fetch wrapper, you should never place secrets or environment variables in a <code>.remote.ts</code> function. But as always, be mindful of what your functions can access.</p> <hr/> <h2>What Remote Functions Solve (and What They Don’t)</h2> <h3>Pros</h3> <ul><li><strong>Colocation</strong>: logic lives next to UI</li> <li><strong>Type safety</strong>: client and server share types</li> <li><strong>Cleaner API calls</strong>: you don’t need to manually write endpoints and fetch calls</li> <li><strong>Automatic serialization and caching</strong></li> <li><strong>Optimistic updates and query invalidation built in</strong></li></ul> <h3>Limitations / things to watch</h3> <ul><li>Sometimes <code>load</code> is still more appropriate, especially when wanting to bundle multiple data fetches for a page</li> <li>Not a full replacement for API-only backends (if you have a completely separate backend, bridging may need extra glue)</li> <li>Because it’s experimental, behavior might shift</li> <li>Current limitations in SSR / hydration edge cases</li></ul> <p>As one commenter put it:</p> <blockquote><p>“I was sick of setting up +server.js just to run one DB query. Can’t wait to delete half my API routes.” (<a href="https://www.reddit.com/r/sveltejs/comments/1ldv5cr/new_sveltekit_concept_remote_functions/?utm_source=chatgpt.com" title="New SvelteKit concept: Remote functions : r/sveltejs - Reddit" rel="nofollow">Reddit</a>)</p></blockquote> <p>Remote Functions don’t necessarily remove <code>load</code> functions entirely — they complement them. For example, <code>load</code> works at the page-level, bundling multiple data needs together, while remote functions give you more granular control.</p> <h2>Conclusion & What’s Next</h2> <p>SvelteKit’s Remote Functions open a new paradigm: writing server logic that feels like local functions, with type safety and automatic fetch plumbing. For many apps, this will reduce boilerplate and bring code much closer to UI.</p> <p>As this feature matures, I expect:</p> <ul><li>Better tooling (IDE support, debugging)</li> <li>Wider adoption of batching or automatic deduplication</li> <li>More patterns and best practices emerging</li></ul> <p>If you’re trying it today, treat it as experimental but powerful.</p> <p>Want more examples or a deeper dive into <code>form.enhance</code>, query batching, or handling file uploads via Remote Functions? Let me know — I’d be happy to expand with real-world demos.</p>',1);function $s(l){var p=Hs(),e=s(F(p),28),u=n(e);t(u,()=>`<code class="language-js"><span class="token comment">// svelte.config.js</span>
<span class="token comment">/** @type &#123;import('@sveltejs/kit').Config&#125; */</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">kit</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">experimental</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token literal-property property">remoteFunctions</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">compilerOptions</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">experimental</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> config<span class="token punctuation">;</span></code>`),a(e);var i=s(e,20),k=n(i);t(k,()=>`<code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> query <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'$app/server'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> getPosts <span class="token operator">=</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// server logic: fetch from DB, external API, etc.</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">fetchSomePosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>`),a(i);var c=s(i,4),d=n(c);t(d,()=>`<code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> query <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'$app/server'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> z <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'zod'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> getUser <span class="token operator">=</span> <span class="token function">query</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>userId<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">fetchUserById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>`),a(c);var o=s(c,4),f=n(o);t(f,()=>`<code class="language-svelte"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getPosts <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./posts.remote'</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token each"><span class="token punctuation">&#123;</span><span class="token keyword">#each</span> <span class="token language-javascript">posts </span><span class="token keyword">as</span> <span class="token language-javascript">post<span class="token punctuation">&#125;</span></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token language-javascript"><span class="token punctuation">&#123;</span>post<span class="token punctuation">.</span>title<span class="token punctuation">&#125;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token each"><span class="token punctuation">&#123;</span><span class="token keyword">/each</span><span class="token punctuation">&#125;</span></span></code>`),a(o);var r=s(o,8),m=n(r);t(m,()=>`<code class="language-svelte"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getPosts <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./posts.remote'</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> q <span class="token operator">=</span> <span class="token function">getPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// now q has &#96;loading&#96;, &#96;error&#96;, &#96;current&#96;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token language-javascript"><span class="token punctuation">&#123;</span>#<span class="token keyword">if</span> q<span class="token punctuation">.</span>error<span class="token punctuation">&#125;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Error: <span class="token language-javascript"><span class="token punctuation">&#123;</span>q<span class="token punctuation">.</span>error<span class="token punctuation">.</span>message<span class="token punctuation">&#125;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">:</span><span class="token keyword">else</span> <span class="token keyword">if</span> q<span class="token punctuation">.</span>loading<span class="token punctuation">&#125;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Loading...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">:</span><span class="token keyword">else</span><span class="token punctuation">&#125;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>
    <span class="token each"><span class="token punctuation">&#123;</span><span class="token keyword">#each</span> <span class="token language-javascript">q<span class="token punctuation">.</span>current </span><span class="token keyword">as</span> <span class="token language-javascript">post<span class="token punctuation">&#125;</span></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token language-javascript"><span class="token punctuation">&#123;</span>post<span class="token punctuation">.</span>title<span class="token punctuation">&#125;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
    <span class="token each"><span class="token punctuation">&#123;</span><span class="token keyword">/each</span><span class="token punctuation">&#125;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
<span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token punctuation">&#125;</span></span></code>`),a(r);var g=s(r,8),S=n(g);t(S,()=>`<code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> command <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'$app/server'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> addLike <span class="token operator">=</span> <span class="token function">command</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>postId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">await</span> <span class="token function">incrementLikesInDatabase</span><span class="token punctuation">(</span>postId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> success<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>`),a(g);var h=s(g,8),T=n(h);t(T,()=>`<code class="language-ts"><span class="token comment">// comments.remote.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> form <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'$app/server'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> z <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'zod'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> commentSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  postId<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  content<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> addComment <span class="token operator">=</span> <span class="token function">form</span><span class="token punctuation">(</span>commentSchema<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> invalid<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>invalid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> success<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> errors<span class="token operator">:</span> invalid <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">await</span> <span class="token function">createComment</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>postId<span class="token punctuation">,</span> data<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> success<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>`),a(h);var y=s(h,4),R=n(y);t(R,()=>`<code class="language-svelte"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">&#123;</span> addComment <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./comments.remote'</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> result<span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">...</span>addComment<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>postId<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">value=</span><span class="token language-javascript"><span class="token punctuation">&#123;</span>postId<span class="token punctuation">&#125;</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>

<span class="token language-javascript"><span class="token punctuation">&#123;</span>#<span class="token keyword">if</span> addComment<span class="token punctuation">.</span>result<span class="token operator">?.</span>success<span class="token punctuation">&#125;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Comment added!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">:</span><span class="token keyword">else</span> <span class="token keyword">if</span> addComment<span class="token punctuation">.</span>result<span class="token operator">?.</span>errors<span class="token punctuation">&#125;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Errors: <span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>addComment<span class="token punctuation">.</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token punctuation">&#125;</span></span></code>`),a(y);var v=s(y,16),x=n(v);t(x,()=>`<code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> query<span class="token punctuation">,</span> command <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'$app/server'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Todo</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  done<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// In memory store (for demo)</span>
<span class="token keyword">let</span> todos<span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">"Buy milk"</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> getTodos <span class="token operator">=</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> todos<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> addTodo <span class="token operator">=</span> <span class="token function">command</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> newTodo<span class="token operator">:</span> Todo <span class="token operator">=</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> crypto<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  todos <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token operator">...</span>todos<span class="token punctuation">,</span> newTodo <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> newTodo<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> toggleTodo <span class="token operator">=</span> <span class="token function">command</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  todos <span class="token operator">=</span> todos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token operator">=></span>
    t<span class="token punctuation">.</span>id <span class="token operator">===</span> id <span class="token operator">?</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>t<span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token operator">!</span>t<span class="token punctuation">.</span>done <span class="token punctuation">&#125;</span> <span class="token operator">:</span> t
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> success<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>`),a(v);var b=s(v,4),D=n(b);t(D,()=>`<code class="language-svelte"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getTodos<span class="token punctuation">,</span> addTodo<span class="token punctuation">,</span> toggleTodo <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./todos.remote'</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> todos <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleAdd</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> SubmitEvent</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> form <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget <span class="token keyword">as</span> HTMLFormElement<span class="token punctuation">;</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token punctuation">(</span>form<span class="token punctuation">.</span>elements<span class="token punctuation">.</span><span class="token function">namedItem</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLInputElement<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">addTodo</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">updates</span><span class="token punctuation">(</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleToggle</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">await</span> <span class="token function">toggleTodo</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">updates</span><span class="token punctuation">(</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name"><span class="token namespace">on:</span>submit=</span><span class="token language-javascript"><span class="token punctuation">&#123;</span>handleAdd<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Add<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>
  <span class="token each"><span class="token punctuation">&#123;</span><span class="token keyword">#each</span> <span class="token language-javascript">todos </span><span class="token keyword">as</span> <span class="token language-javascript">t<span class="token punctuation">&#125;</span></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span>
          <span class="token attr-name">checked=</span><span class="token language-javascript"><span class="token punctuation">&#123;</span>t<span class="token punctuation">.</span>done<span class="token punctuation">&#125;</span></span>
          <span class="token attr-name"><span class="token namespace">on:</span>change=</span><span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">handleToggle</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span> <span class="token punctuation">/></span></span>
        <span class="token language-javascript"><span class="token punctuation">&#123;</span>t<span class="token punctuation">.</span>text<span class="token punctuation">&#125;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
  <span class="token each"><span class="token punctuation">&#123;</span><span class="token keyword">/each</span><span class="token punctuation">&#125;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></code>`),a(b),L(60),_(l,p)}const Ns=Object.freeze(Object.defineProperty({__proto__:null,default:$s,metadata:X},Symbol.toStringTag,{value:"Module"}));async function hn(){const l=Object.assign({"/src/content/blog/deployment.svx":Gs,"/src/content/blog/react-future-nextjs-shadow.svx":Us,"/src/content/blog/remote-function-sveltekit.svx":Ns}),p=[];for(const[e,u]of Object.entries(l)){const i=e.split("/").pop()?.replace(".svx","")||"",k=u;k.metadata&&p.push({slug:i,metadata:k.metadata,component:k.default})}return p.sort((e,u)=>new Date(u.metadata.date).getTime()-new Date(e.metadata.date).getTime())}function yn(l){return new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}export{Ls as C,yn as f,hn as l};
